<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
        <link rel="stylesheet" type="text/css" href="css/index.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
        <script src="https://unpkg.com/vue@3.2.31"></script>
        <!-- <script type="text/javascript" src="js/index.js"></script> -->
    </head>
    <body>
    <div id="vueApp">
        <div class="container">
            <h1 id="header">LATZY</h1>
        </div>

        <div id="divGameBoard">
            <span id="alertUser" class="alert alert-secondary" style="text-align:center; display:none;"></span>
            <div id="rowOne">
                <div class="columnOne"><input id="OneOne" class="inRowOne" type="text" maxlength="1" autocomplete="off"></div>
                <div class="columnTwo"><input id="OneTwo" class="inRowOne" type="text" maxlength="1" autocomplete="off"></div>
                <div class="columnThree"><input id="OneThree" class="inRowOne" type="text" maxlength="1" autocomplete="off"></div>
                <div class="columnFour"><input id="OneFour" class="inRowOne" type="text" maxlength="1" autocomplete="off"></div>
                <div class="columnFive"><input id="OneFive" class="inRowOne" type="text" maxlength="1" autocomplete="off"></div>
            </div>
            <div id="rowTwo">
                <div class="columnOne"><input id="TwoOne" class="inRowTwo" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnTwo"><input id="TwoTwo" class="inRowTwo" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnThree"><input id="TwoThree" class="inRowTwo" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFour"><input id="TwoFour" class="inRowTwo" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFive"><input id="TwoFive" class="inRowTwo" type="text" maxlength="1" autocomplete="off" disabled></div>
            </div>
            <div id="rowThree">
                <div class="columnOne"><input id="ThreeOne" class="inRowThree" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnTwo"><input id="ThreeTwo" class="inRowThree" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnThree"><input id="ThreeThree" class="inRowThree" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFour"><input id="ThreeFour" class="inRowThree" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFive"><input id="ThreeFive" class="inRowThree" type="text" maxlength="1" autocomplete="off" disabled></div>
            </div>
            <div id="rowFour">
                <div class="columnOne"><input id="FourOne" class="inRowFour" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnTwo"><input id="FourTwo" class="inRowFour" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnThree"><input id="FourThree" class="inRowFour" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFour"><input id="FourFour" class="inRowFour" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFive"><input id="FourFive" class="inRowFour" type="text" maxlength="1" autocomplete="off" disabled></div>
            </div>
            <div id="rowFive">
                <div class="columnOne"><input id="FiveOne" class="inRowFive" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnTwo"><input id="FiveTwo" class="inRowFive" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnThree"><input id="FiveThree" class="inRowFive" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFour"><input id="FiveFour" class="inRowFive" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFive"><input id="FiveFive" class="inRowFive" type="text" maxlength="1" autocomplete="off" disabled></div>
            </div>
            <div id="rowSix">
                <div class="columnOne"><input id="SixOne" class="inRowSix" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnTwo"><input id="SixTwo" class="inRowSix" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnThree"><input id="SixThree" class="inRowSix" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFour"><input id="SixFour" class="inRowSix" type="text" maxlength="1" autocomplete="off" disabled></div>
                <div class="columnFive"><input id="SixFive" class="inRowSix" type="text" maxlength="1" autocomplete="off" disabled></div>
            </div>
        </div>
        <div id='footer'>
            <button id="btnSubmit" class="btn btn-default" v-on:click="checkGuess()">Check Guess</button>
        </div>

        <!-- Directions pop up dialog -->
        <div class="modal fade" id="directionsModal" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">How To Play</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="directionIntro">
                            <p>You have six ties to guess the word</p>
                            <p>Each guess must be a valid five-letter word. Hit the enter button to check your guess.</p>
                            <p>After each guess, the color of the tiles will change to show how close your guess was to the word.</p>
                        </div>
                        <hr>
                        <div class="directionExamples">
                            <p><stong>Examples</stong></p>
                            <div class="fullCorrectLetterExample">
                                <div class="divWordExample" style="background-color: darkorange; border:1px solid darkorange;"><label class="wordExample">B</label></div>
                                <div class="divWordExample"><label class="wordExample">R</label></div>
                                <div class="divWordExample"><label class="wordExample">E</label></div>
                                <div class="divWordExample"><label class="wordExample">A</label></div>
                                <div class="divWordExample"><label class="wordExample">D</label></div>
                                <p>The letter <strong>B</strong> is in the word and is in the correct spot</p>
                            </div>
                            <div class="halfCorrectLetterExample">
                                <div class="divWordExample"><label class="wordExample">F</label></div>
                                <div class="divWordExample"><label class="wordExample">R</label></div>
                                <div class="divWordExample" style="background-color: gold; border:1px solid gold;"><label class="wordExample">A</label></div>
                                <div class="divWordExample"><label class="wordExample">M</label></div>
                                <div class="divWordExample"><label class="wordExample">E</label></div>
                                <p>The letter <strong>A</strong> is in the word but in the wrong spot</p>
                            </div>
                            <div class="incorrectLetterExample">
                                <div class="divWordExample"><label class="wordExample">A</label></div>
                                <div class="divWordExample"><label class="wordExample">N</label></div>
                                <div class="divWordExample"><label class="wordExample">G</label></div>
                                <div class="divWordExample" style="background-color: grey; border:1px solid grey;"><label class="wordExample">L</label></div>
                                <div class="divWordExample"><label class="wordExample">E</label></div>
                                <p>The letter <strong>L</strong> is not in the word in any spot</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        Vue.createApp({
            data() {
                return {
                    count: 0
                }
            },
            mounted() {
                $('#directionsModal').modal('show');

                $("#OneFive").on("keydown", (event) => {
                    this.keyDownEvent(event);
                });
                $("#TwoFive").on("keydown", (event) => {
                    this.keyDownEvent(event);
                });
                $("#ThreeFive").on("keydown", (event) => {
                    this.keyDownEvent(event);
                });
                $("#FourFive").on("keydown", (event) => {
                    this.keyDownEvent(event);
                });
                $("#FiveFive").on("keydown", (event) => {
                    this.keyDownEvent(event);
                });
                $("#SixFive").on("keydown", (event) => {
                    this.keyDownEvent(event);
                });
            },
            methods: {
                keyDownEvent(event) {
                    let keyPressed = event.keyCode || event.which;
                    if (keyPressed === 13) {
                        event.preventDefault();
                        $("#btnSubmit").click();
                    }
                },
                checkGuess() {
                    let userGuessWord = this.retrieveUserGuessWord();          
                    if (!userGuessWord.match('[a-zA-Z]{5}')){
                        this.alertTheUser("Invalid Word");
                        return;
                    }

                    $.ajax({
                        type: 'GET',
                        url: `/spellcheck/${userGuessWord}`
                    })
                    .done((msg) => {
                        //console.log(msg);
                        validWord = msg.isSpelledCorrectly;
                        if(validWord){
                            this.giveWordFeedback(msg.disectedArray);
                            if(this.checkWinner(msg.disectedArray)) {
                                this.alertTheUser("Congrats!! You Won");
                                this.disableWinningRow();
                                return;
                            }
                            this.moveToNextWord(msg.generatedGuessWord);
                        }
                        else {
                            this.alertTheUser("Word not found in dictionary");
                        }      
                    })
                    .fail((msg) => {
                        console.log(msg);
                    });
                },
                retrieveUserGuessWord() {
                    let userGuessWord = '';
                    switch(this.count) {
                        case 0:
                            var charOne = $('#OneOne').val();
                            var charTwo = $('#OneTwo').val();
                            var charThree = $('#OneThree').val();
                            var charFour = $('#OneFour').val();
                            var charFive = $('#OneFive').val();
                            userGuessWord = charOne + charTwo + charThree + charFour + charFive;
                            break;
                        case 1:
                            var charOne = $('#TwoOne').val();
                            var charTwo = $('#TwoTwo').val();
                            var charThree = $('#TwoThree').val();
                            var charFour = $('#TwoFour').val();
                            var charFive = $('#TwoFive').val();
                            userGuessWord = charOne + charTwo + charThree + charFour + charFive;
                            break;
                        case 2:
                            var charOne = $('#ThreeOne').val();
                            var charTwo = $('#ThreeTwo').val();
                            var charThree = $('#ThreeThree').val();
                            var charFour = $('#ThreeFour').val();
                            var charFive = $('#ThreeFive').val();
                            userGuessWord = charOne + charTwo + charThree + charFour + charFive;
                            break;
                        case 3:
                            var charOne = $('#FourOne').val();
                            var charTwo = $('#FourTwo').val();
                            var charThree = $('#FourThree').val();
                            var charFour = $('#FourFour').val();
                            var charFive = $('#FourFive').val();
                            userGuessWord = charOne + charTwo + charThree + charFour + charFive;
                            break;
                        case 4:
                            var charOne = $('#FiveOne').val();
                            var charTwo = $('#FiveTwo').val();
                            var charThree = $('#FiveThree').val();
                            var charFour = $('#FiveFour').val();
                            var charFive = $('#FiveFive').val();
                            userGuessWord = charOne + charTwo + charThree + charFour + charFive;
                            break;
                        case 5:
                            var charOne = $('#SixOne').val();
                            var charTwo = $('#SixTwo').val();
                            var charThree = $('#SixThree').val();
                            var charFour = $('#SixFour').val();
                            var charFive = $('#SixFive').val();
                            userGuessWord = charOne + charTwo + charThree + charFour + charFive;
                            break;
                        default:
                    }
                    return userGuessWord.toLowerCase();
                },
                giveWordFeedback(disectedArray) {
                    switch(this.count) {
                        case 0:
                            $.each(disectedArray, (index, value) => {
                                switch(index) {
                                    case 0:
                                        this.addCSSClass('#OneOne', value);
                                        break;
                                    case 1:
                                        this.addCSSClass('#OneTwo', value);
                                        break;
                                    case 2:
                                        this.addCSSClass('#OneThree', value);
                                        break;
                                    case 3:
                                        this.addCSSClass('#OneFour', value);
                                        break;
                                    case 4:
                                        this.addCSSClass('#OneFive', value);
                                        break;
                                    default:
                                        alert('In giveWordFeedBack case 0 Switch Statement Default');
                                }
                            });
                            break;
                        case 1:
                            $.each(disectedArray, (index, value) => {
                                    switch(index) {
                                        case 0:
                                            this.addCSSClass('#TwoOne', value);
                                            break;
                                        case 1:
                                            this.addCSSClass('#TwoTwo', value);
                                            break;
                                        case 2:
                                            this.addCSSClass('#TwoThree', value);
                                            break;
                                        case 3:
                                            this.addCSSClass('#TwoFour', value);
                                            break;
                                        case 4:
                                            this.addCSSClass('#TwoFive', value);
                                            break;
                                        default:
                                            alert('In giveWordFeedBack case 1 Switch Statement Default');
                                    }
                                });
                            break;
                        case 2:
                            $.each(disectedArray, (index, value) => {
                                    switch(index) {
                                        case 0:
                                            this.addCSSClass('#ThreeOne', value);
                                            break;
                                        case 1:
                                            this.addCSSClass('#ThreeTwo', value);
                                            break;
                                        case 2:
                                            this.addCSSClass('#ThreeThree', value);
                                            break;
                                        case 3:
                                            this.addCSSClass('#ThreeFour', value);
                                            break;
                                        case 4:
                                            this.addCSSClass('#ThreeFive', value);
                                            break;
                                        default:
                                            alert('In giveWordFeedBack case 2 Switch Statement Default');
                                    }
                                });
                            break;
                        case 3:
                            $.each(disectedArray, (index, value) => {
                                    switch(index) {
                                        case 0:
                                            this.addCSSClass('#FourOne', value);
                                            break;
                                        case 1:
                                            this.addCSSClass('#FourTwo', value);
                                            break;
                                        case 2:
                                            this.addCSSClass('#FourThree', value);
                                            break;
                                        case 3:
                                            this.addCSSClass('#FourFour', value);
                                            break;
                                        case 4:
                                            this.addCSSClass('#FourFive', value);
                                            break;
                                        default:
                                            alert('In giveWordFeedBack case 3 Switch Statement Default');
                                    }
                                });
                            break;
                        case 4:
                            $.each(disectedArray, (index, value) => {
                                    switch(index) {
                                        case 0:
                                            this.addCSSClass('#FiveOne', value);
                                            break;
                                        case 1:
                                            this.addCSSClass('#FiveTwo', value);
                                            break;
                                        case 2:
                                            this.addCSSClass('#FiveThree', value);
                                            break;
                                        case 3:
                                            this.addCSSClass('#FiveFour', value);
                                            break;
                                        case 4:
                                            this.addCSSClass('#FiveFive', value);
                                            break;
                                        default:
                                            alert('In giveWordFeedBack case 4 Switch Statement Default');
                                    }
                                });
                            break;
                        case 5:
                            $.each(disectedArray, (index, value) => {
                                    switch(index) {
                                        case 0:
                                            this.addCSSClass('#SixOne', value);
                                            break;
                                        case 1:
                                            this.addCSSClass('#SixTwo', value);
                                            break;
                                        case 2:
                                            this.addCSSClass('#SixThree', value);
                                            break;
                                        case 3:
                                            this.addCSSClass('#SixFour', value);
                                            break;
                                        case 4:
                                            this.addCSSClass('#SixFive', value);
                                            break;
                                        default:
                                            alert('In giveWordFeedBack case 5 Switch Statement Default');
                                    }
                                });
                            break;
                        default:
                            alert('In giveWordFeedBack Switch Statement Default');
                    }
                },
                addCSSClass(inputId, value){
                    // Value has 3 options
                    // 1: Letter does not exist in word
                    // 2: Letter does exist in word and is in the correct spot
                    // 3: Letter does exist in word but is not in the correct spot
                    if (value === '1')
                        $(inputId).addClass("incorrectLetter");
                    else if (value === '2')
                        $(inputId).addClass("fullCorrectLetter");
                    else
                        $(inputId).addClass("halfCorrectLetter");
                
                },
                checkWinner(disectedArray) {
                    let numOfCorrectLetters = 0;
                    $.each(disectedArray, (index, value) => {
                        if(value === '2') {
                            numOfCorrectLetters++;
                        }
                    });
            
                    return numOfCorrectLetters === 5 ? true : false;
                },
                moveToNextWord(generatedGuessWord) {
                    switch(this.count) {
                        case 0:
                            $('.inRowOne').prop('disabled', true);
                            $('.inRowTwo').prop('disabled', false);
                            break;
                        case 1:
                            $('.inRowTwo').prop('disabled', true);
                            $('.inRowThree').prop('disabled', false);
                            break;
                        case 2:
                            $('.inRowThree').prop('disabled', true);
                            $('.inRowFour').prop('disabled', false);
                            break;
                        case 3:    
                            $('.inRowFour').prop('disabled', true);
                            $('.inRowFive').prop('disabled', false);
                            break;
                        case 4:
                            $('.inRowFive').prop('disabled', true);
                            $('.inRowSix').prop('disabled', false);
                            break;
                        case 5:
                            // The Game is finished
                            $('.inRowSix').prop('disabled', true);
                            this.alertTheUser(`Correct word was ${generatedGuessWord}`);
                            break;
                        default:
                            alert('moveToNextWord Switch Statement Default');
                    }
                    this.count++;
                },
                disableWinningRow() {
                    switch(this.count) {
                        case 0:
                            $('.inRowOne').prop('disabled', true);
                            break;
                        case 1:
                            $('.inRowTwo').prop('disabled', true);
                            break;
                        case 2:
                            $('.inRowThree').prop('disabled', true);
                            break;
                        case 3:    
                            $('.inRowFour').prop('disabled', true);
                            break;
                        case 4:
                            $('.inRowFive').prop('disabled', true);
                            break;
                        case 5:
                            $('.inRowSix').prop('disabled', true);
                            break;
                        default:
                            alert('disableWinningRow Switch Statement Default');
                    }
                },
                alertTheUser(alertMsg) {
                    let span = $('#alertUser')[0];
                    span.innerHTML = alertMsg;
                    span.style["display"] = "block";
                    
                    setTimeout(() => {
                        span.style["display"] = "none";    
                    }, 3000);
                }
            }
        }).mount('#vueApp')

    </script>
    </body>
</html>
